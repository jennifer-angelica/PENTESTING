# Preparación para el eJPT (by Peruvian)

![eJPT Image](https://funkyimg.com/i/3a1cK.png)
#### Penetration Testing Student

## Índice y Estructura Principal
- [Resumen](#Resumen)
- [Pre-Requisites](#pre-requisites)
     * [Networking](#networking)
     * [Laboratorio](#laboratorio)
- [Engagement](#engagement)
     * [Tools](#tools)
       * [DNS](#dns)
       * [Wireshark](#wireshark)
- [Information Gathering](#information-gathering)
     * [Tools](#tools)
       * [DNS](#dns)
       * [Wireshark](#wireshark)
- [Footprinting & Scanning](#footprinting-scanning)
     * [Tools](#tools)
       * [DNS](#dns)
       * [Wireshark](#wireshark)
- [Vulnerability Assessment](#vulnerability-assessment)
     * [Tools](#tools)
       * [DNS](#dns)
       * [Wireshark](#wireshark)
- [Exploitation](#exploitation)
     * [Tools](#tools)
       * [DNS](#dns)
       * [Wireshark](#wireshark)
- [Reporting](#reporting)
     * [Tools](#tools)
       * [DNS](#dns)
       * [Wireshark](#wireshark)


Resumen
===============================================================================================================================
En el presente resumen, vamos abarcar temass puntuales y compartir algunas herramientas y comandos de interes para la preparacion EJPT

Pre-Requisites
===============================================================================================================================
Antes que nada me gustaría comentar un poco mi experiencia a la hora de abordar el curso, pues tal vez le sirva de inspiración para aquel que pretenda sacarse la certificación.

#### Networking

En Networking hay que considerar conversiones de decimales a binarios como por ejemplo :
```bash
13 = binario = 1101

13/2 = 6 :: 1
6/2  = 3 :: 0
3/2  = 1 :: 1
1/2  = 0.5: 1
```
Tambien podemos considerar el uso de calculadora de segmentos de red , como se presenta a continuacion 

[A classful calculator](https://www.subnet-calculator.com/)

[A CIDR calculator](https://www.subnet-calculator.com/cidr.php)

Tambien es necesario conocer los puertos mas conocidos

```bash
HTTP: puerto 80
HTTPS: puerto 443
FTP: puerto 21
FTPS/SSH: puerto 22
POP3: puerto 110
POP3 SSL: puerto 995
IMAP: puerto 143
IMAP SSL: puerto 993
SMTP: puerto 25 (alternativas: puerto 26 / puerto 2525)
SMTP SSL: puerto 587
MySQL: puerto 3306
CPanel: puerto 2082
CPanel SSL: puerto 2083
WHM (Webhost Manager): puerto 2086
WHM (Webhost Manager) SSL: puerto 2087
Webmail: puerto 2095
Webmail SSL: puerto 2096
WebDAV/WebDisk: puerto 2077
WebDAV/WebDisk SSL: puerto 2078

```
Para revisar los puertos TCP en modo LISTENING en tu host utiliza :
```bash
•netstat -ano  ::on Windows
•netstat -tunp :: on Linux
```
Tambien podria usar una herramienta grafica de Microsoft
```bash
[TCPView](https://docs.microsoft.com/es-es/sysinternals/downloads/tcpview)
```

#### Laboratorio 

#### Laboratorio : Find_the_secret_Server

Comandos usados para encontrar una ruta y mapearla a nuestra configuracion :
```bash

ifconfig
ip addr
route
ip route add 192.168.xx.x/24 via 10.175.32.1

```

#### Laboratorio: Data_Exfiltration
```bash

**Escenario**

Un cliente le brinda acceso de escritorio remoto a una máquina y quiere que identifique todas las formas posibles en que un atacante puede exfiltrar datos (es decir, si pudo comprometer esta máquina) sin cambiar ninguna configuración del firewall.
Si no está familiarizado con el término exfiltración, consulte el enlace a continuación.
https://attack.mitre.org/tactics/TA0010/
Nota: Esta práctica de laboratorio debe realizarse desde dentro de Kali Linux u otra distribución de pentesting, máquina virtual.

En este laboratorio, aprenderá a:
• Evaluar la configuración del firewall
• Aproveche la configuración de firewall insuficientemente segura
• Cifre datos interesantes y extráigalos mediante DNS
• Identificar automáticamente todas las posibles formas de exfiltración

Herramientas recomendadas :

• Kali Linux
• Packet Whisper [Link](https://github.com/TryCatchHCF/PacketWhisper)
• Wireshark
• rdesktop (command line utility)
• Egress framework [Link](https://labs.mwrinfosecurity.com/blog/egress-checking)

**Datos del Laboratorio**

•Target:172.16.91.100
```
**Resolución**

1. Siempre es bueno hacer un Scanning del objetivo **172.16.91.100** y ver que puertos y servicios tienen abierto

```bash
nmap -vv -sn -n 172.16.91.0/24
```
```bash
nmap -vv -Pn -sV -sC 172.16.91.100
```
2. Luego scanear en busca de algun puerto UDP abierto
```bash
nmap -vv -sU -sV -sC 172.16.91.100

PORT   STATE         SERVICE VERSION
53/udp open|filtered domain
```
3. Conectarnos al objetivo de manera remota con las credenciales brindadas 
```bash
rdesktop 172.16.91.100
```

4. Una vez en la maquina target Windows 10, buscar en programs, script languages (Python,Powershell,VS,etc),tambien buscar archivos claves:
```bash
rdesktop 172.16.91.100
```

5. No es raro encontrar puertos como 80 (TCP), 443 (TCP), 8080 (TCP), 8443 (TCP) y 53 (UDP) que tienen permitida la conectividad de salida. Identifique si el firewall de la máquina 172.16.91.100 permite la conectividad saliente a alguno de esos puertos.
Sugerencia: puede usar un servidor HTTP Python o Wireshark (en su máquina Kali) y el navegador de la máquina 172.16.91.100 para ayudarlo con esta tarea.

6. Intente extraer cualquier archivo interesante que haya identificado en la Tarea 1 y guárdelo en su máquina Kali. Para hacerlo, aproveche los puertos de conectividad de salida permitidos que identificó durante la Tarea 2.
```bash
Sugerencias:
1. A menudo, los probadores de penetración profesionales exfiltran datos a través de solicitudes de DNS para evadir la detección.
2. PacketWhisper es una gran herramienta para realizar la exfiltración de DNS
```
7. Busque herramientas / marcos automatizados que automaticen el proceso de identificación de todas las posibles rutas de exfiltración y utilice una de ellas para identificar una ruta de exfiltración diferente a la utilizada en la Tarea 3.
```bash
Sugerencias:
1. https://github.com/stufus/egresscheck-framework.git es una buena solución para enumerar automáticamente todas las posibles formas de exfiltración
2. Existe otro puerto que tiene permitida la conectividad saliente. Este puerto está entre 8500 y 9500 (TCP).
```
Engagement
===============================================================================================================================
Antes que nada me gustaría comentar un poco mi experiencia a la hora de abordar el curso, pues tal vez le sirva de inspiración para aquel que pretenda sacarse la certificación.

#### ¿Es difícil la certificación?

Diría que la respuesta es relativa, siempre va a depender de la soltura que tengas con máquinas de tipo _CTF/Challenge_. 

A mi por ejemplo la plataforma **HackTheBox** me ha servido de mucho para coger todo el fondo que tengo a día de hoy, así como **VulnHub** u **OverTheWire**. De hecho, lo que más me sorprendió a la hora de ir haciendo las máquinas del laboratorio fue la gran similitud con las máquinas de HackTheBox. Hablando en términos comparativos, os puedo decir que efectivamente corresponden a las de nivel medio de HTB, tal y como llegué a leer en su momento en algunos artículos de gente que había pasado con éxito la certificación.


